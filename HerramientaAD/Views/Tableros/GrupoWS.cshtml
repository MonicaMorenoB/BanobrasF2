@model HerramientaAD.Models.GrupoWSModel

@{
    ViewBag.Title = "Resultados del Análisis de Servicios e Interfases";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!DOCTYPE HTML>
<html>

<head>
    <script>
        window.onload = function () {

            var Datos = [];

            @{
                foreach (HerramientaAD.com.Utilerias.ElementosDeGrupo.GraficaPie grafica in Model.ArchivosPie)
                {
                    @:Datos.push({ y: @grafica.Porcentaje, name: "@grafica.Nombre", exploded: true });
                }
            }

            var chart = new CanvasJS.Chart("graficaArchivosPie", {
                exportEnabled: true,
                animationEnabled: true,
                title: {
                    text: "Tipos de Archivos Analizados",
                    fontFamily: "Segoe UI"
                },
                legend: {
                    cursor: "pointer",
                    itemclick: explodePie
                },
                data: [{
                    type: "pie",
                    showInLegend: false,
                    toolTipContent: "{name}: <strong>{y}%</strong>",
                    indexLabel: "{name} - {y}%",
                    dataPoints: Datos
                }]
            });

            chart.render();
            Datos = [];

            @{
                foreach (HerramientaAD.com.Utilerias.ElementosDeGrupo.GraficaColumnas grafica in Model.ArchivosColumnas)
                {
                    @:Datos.push({ y: @grafica.EjeY, label: "@grafica.Etiqueta" });
                }
            }

            var chart = new CanvasJS.Chart("graficaArchivosColumnas", {
                animationEnabled: true,
                theme: "light2",
                title: {
                    text: "Servicios Encontrados",
                    fontFamily: "Segoe UI",
                    fontWeight: "normal"
                },
                axisY: {
                    title: "Número de Servicios"
                },
                data: [{
                    type: "column",
                    showInLegend: false,
                    legendMarkerColor: "grey",
                    dataPoints: Datos
                }]
            });

            chart.render();
            Datos = [];

            @{
                foreach (HerramientaAD.com.Utilerias.ElementosDeGrupo.GraficaBarra grafica in Model.MasUsados)
                {
                    @:Datos.push({ y: @grafica.EjeY, label: "@grafica.Etiqueta" });
                }
            }


            var chart = new CanvasJS.Chart("graficaMasUsados", {
	            animationEnabled: true,
                exportEnabled: true,

	            title:{
                    text: "Servicios más Utilizados en Código",
                    fontFamily: "Segoe UI"
	            },
	            axisX:{
		            interval: 1
	            },
	            axisY2:{
		            interlacedColor: "rgba(1,77,101,.2)",
		            gridColor: "rgba(1,77,101,.1)",
		            title: "Servicios en el Código"
	            },
	            data: [{
                    type: "bar",
		            name: "objetos",
		            axisYType: "secondary",
		            color: "#014D65",
		            dataPoints: Datos

	            }]
            });
            chart.render();
            Datos = [];

            @{
                foreach (HerramientaAD.com.Utilerias.ElementosDeGrupo.GraficaPie grafica in Model.MiddlewarePie)
                {
                    @:Datos.push({ y: @grafica.Porcentaje, name: "@grafica.Nombre", exploded: true });
                }
            }


            var chart = new CanvasJS.Chart("graficaMiddlewarePie", {
                exportEnabled: true,
                animationEnabled: true,
                title: {
                    text: "Tipos de Middleware's Analizados",
                    fontFamily: "Segoe UI"
                },
                legend: {
                    cursor: "pointer",
                    itemclick: explodePie
                },
                data: [{
                    type: "pie",
                    showInLegend: true,
                    toolTipContent: "{name}: <strong>{y}%</strong>",
                    indexLabel: "{name} - {y}%",
                    dataPoints: Datos
                }]
            });

            chart.render();
            Datos = [];

            @{
                foreach (HerramientaAD.com.Utilerias.ElementosDeGrupo.GraficaColumnas grafica in Model.MiddlewareColumnas)
                {
                    @:Datos.push({ y: @grafica.EjeY, label: "@grafica.Etiqueta" });
                }
            }

            var chart = new CanvasJS.Chart("graficaMiddlewareColumnas", {
                animationEnabled: true,
                theme: "light2",
                title: {
                    text: "Tipos de Middleware's Encontrados",
                    fontFamily: "Segoe UI",
                    fontWeight: "normal"
                },
                axisY: {
                    title: "Número de Middleware's"
                },
                data: [{
                    type: "column",
                    showInLegend: false,
                    legendMarkerColor: "grey",
                    dataPoints: Datos
                }]
            });

            chart.render();
            Datos = [];
        }

        function explodePie(e) {
            if (typeof (e.dataSeries.dataPoints[e.dataPointIndex].exploded) === "undefined" || !e.dataSeries.dataPoints[e.dataPointIndex].exploded) {
                e.dataSeries.dataPoints[e.dataPointIndex].exploded = true;
            } else {
                e.dataSeries.dataPoints[e.dataPointIndex].exploded = false;
            }
            e.chart.render();

        }

    </script>

</head>

<body>
    <div class="jumbotron">
        <h1 class="display-3">@Model.Indicadores.ElementAt(0).NombreApp</h1>
        <p class="lead">Resultados del Análisis de Servicios e Interfases</p>
        <hr class="my-4">
    </div>
    <table width="100%" class="table-simple">
        <tr class="table-primary">
            <td colspan="2" align="center">
                <p style="font-size:20px; font-weight:bold">Relación de uso de Servicios que utiliza la Aplicación</p>
            </td>
        </tr>
        <tr>
            <td colspan="2" style="padding:20px">
                <table class="table-indicator" align="center">
                    <tr>
                        <td>
                            <div class="card border-primary mb-3" style="max-width: 20rem; height: 10rem">
                                <div class="card-header">@Model.Indicadores.ElementAt(0).Nombre</div>
                                <div class="card-body">
                                    <table class="table-indicator">
                                        <tr>
                                            <td rowspan="2">
                                                <div class="contenedor">
                                                    <div class="box">
                                                        <img width="70" height="70" src="~/Images/interfaz.png" />
                                                    </div>
                                                </div>
                                            </td>
                                            <td align="center" rowspan="2">
                                                <div class="vl-blanco"></div>
                                            </td>
                                            <td>
                                                <p class="card-text">En Uso</p>
                                                <h1 class="card-title">@Model.Indicadores.ElementAt(0).Usados</h1>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="card border-primary mb-3" style="max-width: 20rem; height: 10rem">
                                <div class="card-header">@Model.Indicadores.ElementAt(1).Nombre</div>
                                <div class="card-body">
                                    <table class="table-indicator">
                                        <tr>
                                            <td rowspan="2">
                                                <div class="contenedor">
                                                    <div class="box">
                                                        <img width="70" height="70" src="~/Images/proceso.png" />
                                                    </div>
                                                </div>
                                            </td>
                                            <td align="center" rowspan="2">
                                                <div class="vl-blanco"></div>
                                            </td>
                                            <td>
                                                <p class="card-text">En Uso</p>
                                                <h1 class="card-title">@Model.Indicadores.ElementAt(1).Usados</h1>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="card border-primary mb-3" style="max-width: 20rem; height: 10rem">
                                <div class="card-header">@Model.Indicadores.ElementAt(2).Nombre</div>
                                <div class="card-body">
                                    <table class="table-indicator">
                                        <tr>
                                            <td rowspan="2">
                                                <div class="contenedor">
                                                    <div class="box">
                                                        <img width="70" height="70" src="~/Images/middleware.png" />
                                                    </div>
                                                </div>
                                            </td>
                                            <td align="center" rowspan="2">
                                                <div class="vl-blanco"></div>
                                            </td>
                                            <td>
                                                <p class="card-text">En Uso</p>
                                                <h1 class="card-title">@Model.Indicadores.ElementAt(2).Usados</h1>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="card border-primary mb-3" style="max-width: 20rem; height: 10rem">
                                <div class="card-header">@Model.Indicadores.ElementAt(3).Nombre</div>
                                <div class="card-body">
                                    <table class="table-indicator">
                                        <tr>
                                            <td rowspan="2">
                                                <div class="contenedor">
                                                    <div class="box">
                                                        <img width="70" height="70" src="~/Images/enlace.png" />
                                                    </div>
                                                </div>
                                            </td>
                                            <td align="center" rowspan="2">
                                                <div class="vl-blanco"></div>
                                            </td>
                                            <td>
                                                <p class="card-text">En Uso</p>
                                                <h1 class="card-title">@Model.Indicadores.ElementAt(3).Usados</h1>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="card border-primary mb-3" style="max-width: 20rem; height: 10rem">
                                <div class="card-header">@Model.Indicadores.ElementAt(4).Nombre</div>
                                <div class="card-body">
                                    <table class="table-indicator">
                                        <tr>
                                            <td rowspan="2">
                                                <div class="contenedor">
                                                    <div class="box">
                                                        <img width="70" height="70" src="~/Images/internet.png" />
                                                    </div>
                                                </div>
                                            </td>
                                            <td align="center" rowspan="2">
                                                <div class="vl-blanco"></div>
                                            </td>
                                            <td>
                                                <p class="card-text">En Uso</p>
                                                <h1 class="card-title">@Model.Indicadores.ElementAt(4).Usados</h1>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="card border-primary mb-3" style="max-width: 20rem; height: 10rem">
                            </div>
                        </td>
                        <td>
                            <div class="card border-primary mb-3" style="max-width: 20rem; height: 10rem">
                            </div>
                        </td>
                        <td>
                            <div class="card border-primary mb-3" style="max-width: 20rem; height: 10rem">
                            </div>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr class="table-primary">
            <td colspan="2" align="center">
                <p style="font-size:20px; font-weight:bold">Estadísticas de Servicios encontrados por Tipo de Archivo</p>
            </td>
        <tr>
            @if (Model.ArchivosColumnas.Count > 0)
            {
                <td style="padding:20px">
                    <div id="graficaArchivosColumnas" style="height: 370px;" />
                </td>
                <td style="padding:20px">
                    <div id="graficaArchivosPie" style="height: 370px;" />
                </td>
            }
            else
            {
                <td colspan="2" align="center" height="200px">
                    <p style="font-size:30px; font-weight:bold">No se encontraron Servicios dentro del Código</p>
                </td>
            }
        </tr>
        <tr class="table-primary">
            <td colspan="2" align="center">
                <p style="font-size:20px; font-weight:bold">Lista de los 10 Servicios más utilizados dentro del Código</p>
            </td>
        </tr>
        <tr>
            @if (Model.MasUsados.Count > 0)
            {
                <td colspan="2" style="padding:20px">
                    <div id="graficaMasUsados" style="height: 370px; width: 100%;" />
                </td>
            }
            else
            {
                <td colspan="2" align="center" height="200px">
                    <p style="font-size:30px; font-weight:bold">No se encontraron Servicios dentro del Código</p>
                </td>
            }
        </tr>
        <tr class="table-primary">
            <td colspan="2" align="center">
                <p style="font-size:20px; font-weight:bold">Estadísticas de los Intermediarios utiliza la Aplicación</p>
            </td>
        <tr>
            @if (Model.MiddlewareColumnas.Count > 0)
            {
                <td style="padding:20px">
                    <div id="graficaMiddlewareColumnas" style="height: 370px;" />
                </td>
                <td style="padding:20px">
                    <div id="graficaMiddlewarePie" style="height: 370px;" />
                </td>
            }
            else
            {
                <td colspan="2" align="center" height="200px">
                    <p style="font-size:30px; font-weight:bold">No se encontraron Intermediarios dentro del Código</p>
                </td>
            }
        </tr>
    </table>

    <script src="~/Scripts/canvasjs.min.js"></script>
</body>

</html>



